{"version":3,"sources":["../../../../../../build/webpack/plugins/webpack-conformance-plugin/checks/minification-conformance-check.ts"],"names":["EARLY_EXIT_RESULT","result","IConformanceTestStatus","SUCCESS","MinificationConformanceCheck","buildStared","options","output","path","endsWith","optimization","minimize","minimizer","length","FAILED","errors","message","CONFORMANCE_ERROR_PREFIX"],"mappings":"iFAAA,+CAKA,uCACA,KAAMA,CAAAA,iBAAyC,CAAG,CAChDC,MAAM,CAAEC,sCAAuBC,OADiB,CAAlD,CAIO,KAAMC,CAAAA,4BAAgE,CACpEC,WAAP,CAAmBC,OAAnB,CAAyD,CACvD,GAAIA,OAAO,CAACC,MAAR,CAAeC,IAAf,CAAoBC,QAApB,CAA6B,SAA7B,CAAJ,CAA6C,CAC3C,MAAOT,CAAAA,iBAAP,CACD,CACD;AACA,KAAM,CAAEU,YAAF,EAAmBJ,OAAzB,CACA,GACEI,YAAY,GACXA,YAAY,CAACC,QAAb,GAA0B,IAA1B,EACED,YAAY,CAACE,SAAb,EAA0BF,YAAY,CAACE,SAAb,CAAuBC,MAAvB,GAAkC,CAFnD,CADd,CAIE,CACA,MAAO,CACLZ,MAAM,CAAEC,sCAAuBY,MAD1B,CAELC,MAAM,CAAE,CACN,CACEC,OAAO,CAAG,GAAEC,mCAAyB,mHADvC,CADM,CAFH,CAAP,CAQD,CAbD,IAaO,CACL,MAAOjB,CAAAA,iBAAP,CACD,CACF,CAvB0E,C","sourcesContent":["import {\n  IWebpackConformanceTest,\n  IConformanceTestResult,\n  IConformanceTestStatus,\n} from '../TestInterface'\nimport { CONFORMANCE_ERROR_PREFIX } from '../constants'\nconst EARLY_EXIT_RESULT: IConformanceTestResult = {\n  result: IConformanceTestStatus.SUCCESS,\n}\n\nexport class MinificationConformanceCheck implements IWebpackConformanceTest {\n  public buildStared(options: any): IConformanceTestResult {\n    if (options.output.path.endsWith('/server')) {\n      return EARLY_EXIT_RESULT\n    }\n    // TODO(prateekbh@): Implement warning for using Terser maybe?\n    const { optimization } = options\n    if (\n      optimization &&\n      (optimization.minimize !== true ||\n        (optimization.minimizer && optimization.minimizer.length === 0))\n    ) {\n      return {\n        result: IConformanceTestStatus.FAILED,\n        errors: [\n          {\n            message: `${CONFORMANCE_ERROR_PREFIX}: Minification is disabled for this build.\\nDisabling minification can result in serious performance degradation.`,\n          },\n        ],\n      }\n    } else {\n      return EARLY_EXIT_RESULT\n    }\n  }\n}\n"]}