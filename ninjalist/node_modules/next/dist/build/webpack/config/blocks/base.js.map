{"version":3,"sources":["../../../../../build/webpack/config/blocks/base.ts"],"names":["isWindows","process","platform","isWslBoolean","base","ctx","config","mode","isDevelopment","name","isServer","target","bail","isProduction","env","__NEXT_TEST_MODE","__NEXT_TEST_WITH_DEVTOOL","devtool","productionBrowserSourceMaps","isClient","module","rules","strictExportPresence"],"mappings":"yDAAA,wEACA,+E,mFAIA,KAAMA,CAAAA,SAAS,CAAGC,OAAO,CAACC,QAAR,GAAqB,OAArB,EAAgCC,cAAlD,CAEO,KAAMC,CAAAA,IAAI,CAAG,oBAAM,QAASA,CAAAA,IAAT,CACxBC,GADwB,CAExBC,MAFwB,CAGxB,CACAA,MAAM,CAACC,IAAP,CAAcF,GAAG,CAACG,aAAJ,CAAoB,aAApB,CAAoC,YAAlD,CACAF,MAAM,CAACG,IAAP,CAAcJ,GAAG,CAACK,QAAJ,CAAe,QAAf,CAA0B,QAAxC,CACAJ,MAAM,CAACK,MAAP,CAAgBN,GAAG,CAACK,QAAJ,CAAe,MAAf,CAAwB,KAAxC,CAEA;AACA;AACA;AACAJ,MAAM,CAACM,IAAP,CAAcP,GAAG,CAACQ,YAAlB,CAEA;AACA,GAAIR,GAAG,CAACG,aAAR,CAAuB,CACrB,GAAIP,OAAO,CAACa,GAAR,CAAYC,gBAAZ,EAAgC,CAACd,OAAO,CAACa,GAAR,CAAYE,wBAAjD,CAA2E,CACzEV,MAAM,CAACW,OAAP,CAAiB,KAAjB,CACD,CAFD,IAEO,IAAIjB,SAAJ,CAAe,CACpB;AACA;AACA;AACAM,MAAM,CAACW,OAAP,CAAiB,mBAAjB,CACD,CALM,IAKA,CACL;AACA;AACA;AACA;AACAX,MAAM,CAACW,OAAP,CAAiB,iBAAjB,CACD,CACF,CAfD,IAeO,CACL;AACA,GAAIZ,GAAG,CAACa,2BAAJ,EAAmCb,GAAG,CAACc,QAA3C,CAAqD,CACnDb,MAAM,CAACW,OAAP,CAAiB,YAAjB,CACD,CAFD,IAEO,CACLX,MAAM,CAACW,OAAP,CAAiB,KAAjB,CACD,CACF,CAED,GAAI,CAACX,MAAM,CAACc,MAAZ,CAAoB,CAClBd,MAAM,CAACc,MAAP,CAAgB,CAAEC,KAAK,CAAE,EAAT,CAAhB,CACD,CACDf,MAAM,CAACc,MAAP,CAAcE,oBAAd,CAAqC,IAArC,CAEA,MAAOhB,CAAAA,MAAP,CACD,CA5CmB,CAAb,C","sourcesContent":["import isWslBoolean from 'next/dist/compiled/is-wsl'\nimport curry from 'next/dist/compiled/lodash.curry'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport { ConfigurationContext } from '../utils'\n\nconst isWindows = process.platform === 'win32' || isWslBoolean\n\nexport const base = curry(function base(\n  ctx: ConfigurationContext,\n  config: webpack.Configuration\n) {\n  config.mode = ctx.isDevelopment ? 'development' : 'production'\n  config.name = ctx.isServer ? 'server' : 'client'\n  config.target = ctx.isServer ? 'node' : 'web'\n\n  // Stop compilation early in a production build when an error is encountered.\n  // This behavior isn't desirable in development due to how the HMR system\n  // works, but is a good default for production.\n  config.bail = ctx.isProduction\n\n  // https://webpack.js.org/configuration/devtool/#development\n  if (ctx.isDevelopment) {\n    if (process.env.__NEXT_TEST_MODE && !process.env.__NEXT_TEST_WITH_DEVTOOL) {\n      config.devtool = false\n    } else if (isWindows) {\n      // Non-eval based source maps are slow to rebuild, so we only enable\n      // them for Windows. Unfortunately, eval source maps are flagged as\n      // suspicious by Windows Defender and block HMR.\n      config.devtool = 'inline-source-map'\n    } else {\n      // `eval-source-map` provides full-fidelity source maps for the\n      // original source, including columns and original variable names.\n      // This is desirable so the in-browser debugger can correctly pause\n      // and show scoped variables with their original names.\n      config.devtool = 'eval-source-map'\n    }\n  } else {\n    // Enable browser sourcemaps:\n    if (ctx.productionBrowserSourceMaps && ctx.isClient) {\n      config.devtool = 'source-map'\n    } else {\n      config.devtool = false\n    }\n  }\n\n  if (!config.module) {\n    config.module = { rules: [] }\n  }\n  config.module.strictExportPresence = true\n\n  return config\n})\n"]}