{"version":3,"sources":["../../../../../../../build/webpack/config/blocks/css/loaders/modules.ts"],"names":["getCssModuleLoader","ctx","postCssPlugins","preProcessors","loaders","isClient","push","isDevelopment","assetPrefix","loader","require","resolve","options","importLoaders","length","sourceMap","esModule","url","cssFileResolve","import","_","resourcePath","modules","exportLocalsConvention","exportOnlyLocals","isServer","mode","getLocalIdent","getCssModuleLocalIdent","postcssOptions","plugins","config","slice","reverse"],"mappings":"mFAGA,gCACA,2CACA,gEAEO,QAASA,CAAAA,kBAAT,CACLC,GADK,CAELC,cAFK,CAGLC,aAAgD,CAAG,EAH9C,CAIqB,CAC1B,KAAMC,CAAAA,OAAiC,CAAG,EAA1C,CAEA,GAAIH,GAAG,CAACI,QAAR,CAAkB,CAChB;AACA;AACAD,OAAO,CAACE,IAAR,CACE,iCAAqB,CACnBC,aAAa,CAAEN,GAAG,CAACM,aADA,CAEnBC,WAAW,CAAEP,GAAG,CAACO,WAFE,CAArB,CADF,EAMD,CAED;AACAJ,OAAO,CAACE,IAAR,CAAa,CACXG,MAAM,CAAEC,OAAO,CAACC,OAAR,CAAgB,+BAAhB,CADG,CAEXC,OAAO,CAAE,CACPC,aAAa,CAAE,EAAIV,aAAa,CAACW,MAD1B,CAEPC,SAAS,CAAE,IAFJ,CAGP;AACAC,QAAQ,CAAE,KAJH,CAKPC,GAAG,CAAEC,2BALE,CAMPC,MAAM,CAAE,CAACF,GAAD,CAAcG,CAAd,CAAsBC,YAAtB,GACN,gCAAeJ,GAAf,CAAoBI,YAApB,CAPK,CAQPC,OAAO,CAAE,CACP;AACAC,sBAAsB,CAAE,MAFjB,CAGP;AACAC,gBAAgB,CAAEvB,GAAG,CAACwB,QAJf,CAKP;AACA;AACAC,IAAI,CAAE,MAPC,CAQP;AACA;AACA;AACA;AACA;AACAC,aAAa,CAAEC,8CAbR,CARF,CAFE,CAAb,EA4BA;AACAxB,OAAO,CAACE,IAAR,CAAa,CACXG,MAAM,CAAEC,OAAO,CAACC,OAAR,CAAgB,mCAAhB,CADG,CAEXC,OAAO,CAAE,CACPiB,cAAc,CAAE,CAAEC,OAAO,CAAE5B,cAAX,CAA2B6B,MAAM,CAAE,KAAnC,CADT,CAEPhB,SAAS,CAAE,IAFJ,CAFE,CAAb,EAQAX,OAAO,CAACE,IAAR,CACE;AACA;AACA,GAAGH,aAAa,CAAC6B,KAAd,GAAsBC,OAAtB,EAHL,EAMA,MAAO7B,CAAAA,OAAP,CACD","sourcesContent":["import { AcceptedPlugin } from 'postcss'\nimport { webpack } from 'next/dist/compiled/webpack/webpack'\nimport { ConfigurationContext } from '../../../utils'\nimport { getClientStyleLoader } from './client'\nimport { cssFileResolve } from './file-resolve'\nimport { getCssModuleLocalIdent } from './getCssModuleLocalIdent'\n\nexport function getCssModuleLoader(\n  ctx: ConfigurationContext,\n  postCssPlugins: readonly AcceptedPlugin[],\n  preProcessors: readonly webpack.RuleSetUseItem[] = []\n): webpack.RuleSetUseItem[] {\n  const loaders: webpack.RuleSetUseItem[] = []\n\n  if (ctx.isClient) {\n    // Add appropriate development more or production mode style\n    // loader\n    loaders.push(\n      getClientStyleLoader({\n        isDevelopment: ctx.isDevelopment,\n        assetPrefix: ctx.assetPrefix,\n      })\n    )\n  }\n\n  // Resolve CSS `@import`s and `url()`s\n  loaders.push({\n    loader: require.resolve('next/dist/compiled/css-loader'),\n    options: {\n      importLoaders: 1 + preProcessors.length,\n      sourceMap: true,\n      // Use CJS mode for backwards compatibility:\n      esModule: false,\n      url: cssFileResolve,\n      import: (url: string, _: any, resourcePath: string) =>\n        cssFileResolve(url, resourcePath),\n      modules: {\n        // Do not transform class names (CJS mode backwards compatibility):\n        exportLocalsConvention: 'asIs',\n        // Server-side (Node.js) rendering support:\n        exportOnlyLocals: ctx.isServer,\n        // Disallow global style exports so we can code-split CSS and\n        // not worry about loading order.\n        mode: 'pure',\n        // Generate a friendly production-ready name so it's\n        // reasonably understandable. The same name is used for\n        // development.\n        // TODO: Consider making production reduce this to a single\n        // character?\n        getLocalIdent: getCssModuleLocalIdent,\n      },\n    },\n  })\n\n  // Compile CSS\n  loaders.push({\n    loader: require.resolve('next/dist/compiled/postcss-loader'),\n    options: {\n      postcssOptions: { plugins: postCssPlugins, config: false },\n      sourceMap: true,\n    },\n  })\n\n  loaders.push(\n    // Webpack loaders run like a stack, so we need to reverse the natural\n    // order of preprocessors.\n    ...preProcessors.slice().reverse()\n  )\n\n  return loaders\n}\n"]}